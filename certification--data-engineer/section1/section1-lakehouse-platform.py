# Databricks notebook source
# MAGIC %md
# MAGIC # ■ セクション 1: Databricks レイクハウスプラットフォーム

# COMMAND ----------

# MAGIC %md
# MAGIC ## ● データレイクハウスとデータウェアハウスの関係を説明する。
# MAGIC
# MAGIC ### ○ `[Azure 公式 HP]レイクハウスとデータ レイクとデータ ウェアハウスの比較`からの抜粋・転記
# MAGIC
# MAGIC データ ウェアハウスはデータ フローをコントロールするシステムの設計ガイドラインのセットとして進化しつつ、約 30 年間にわたってビジネス インテリジェンス (BI) による意思決定を支えてきました。 エンタープライズ データ ウェアハウスは BI レポートのクエリを最適化しますが、結果を生成するには数分から数時間かかることがあります。 高頻度で変更される可能性が低いデータ用に設計されたデータ ウェアハウスは、同時に実行されるクエリ間の競合を防ぐことを目的としています。 多くのデータ ウェアハウスは独自の形式に依存しているため、機械学習のサポートが制限されることがよくあります。 Azure Databricks のデータ ウェアハウスでは、Databricks レイクハウスと Databricks SQL の機能を活用します。 詳細については、「Azure Databricks のデータ ウェアハウスとは」を参照してください。
# MAGIC
# MAGIC データ ストレージの技術の進歩と、データの種類と量の急激な増加により、データ レイクは過去 10 年間に広く使用されるようになりました。 データ レイクは、データを安価かつ効率的に格納および処理します。 データ レイクは、多くの場合、データ ウェアハウスとは対立する形で定義されます。データ ウェアハウスは、BI 分析用にクリーンで構造化されたデータを提供しますが、データ レイクはあらゆる性質のデータを任意の形式で永続的かつ安価に格納します。 多くの組織では、データ サイエンスと機械学習にデータ レイクを使用しますが、未検証の性質のため BI レポートには使用しません。
# MAGIC
# MAGIC データ レイクハウスは、データ レイクとデータ ウェアハウスの強みをかけ合わせて、次のような機能を提供します。
# MAGIC
# MAGIC 標準データ形式で格納データへのオープンな直接アクセス。
# MAGIC 機械学習とデータ サイエンス用に最適化されたインデックス作成プロトコル。
# MAGIC BI と高度な分析のための低いクエリ待機時間と高い信頼性。
# MAGIC 最適化されたメタデータ レイヤーと、クラウド オブジェクト ストレージに標準形式で保存された検証済みデータを組み合わせることで、データ レイクハウスは、データ サイエンティストや ML エンジニアが、同じデータに基づいた BI レポートからモデルを構築することを可能にします。
# MAGIC
# MAGIC ### ○ セミナーでの説明（汚いメモ）を補足として追記
# MAGIC
# MAGIC ```
# MAGIC ・データレイクハウス ＝ データレイク＋データウェアハウス
# MAGIC     データレイク: 非定型・非構造データ。データ管理が難しい。あとで使う時に意味を与えて使う。
# MAGIC     データウェアハウス： 非構造データを扱うのが難しい。MLで難しい。
# MAGIC     2つのいいとこどり
# MAGIC     オープン技術
# MAGIC     トランザクション性を持っている。
# MAGIC     標準的なデータフォーマットをベースにしている
# MAGIC     オブジェクトストレージにACIDを持たせた。
# MAGIC       大量データ書き込み中に失敗して中途半端になるようなことがない。
# MAGIC       データの追加Appendが難しくなくなる
# MAGIC       既存データの改変は困難でなくなる
# MAGIC ```
# MAGIC
# MAGIC ### ○ 参考記事
# MAGIC - データ レイクハウスとは
# MAGIC   - https://learn.microsoft.com/ja-jp/azure/databricks/lakehouse/
# MAGIC - レイクハウスとデータ レイクとデータ ウェアハウスの比較
# MAGIC   - https://learn.microsoft.com/ja-jp/azure/databricks/lakehouse/#lakehouse-vs-data-lake-vs-data-warehouse

# COMMAND ----------

# MAGIC %md
# MAGIC ## ● データレイクとの比較で、データレイクハウスにおけるデータ品質の改善点を特定する。
# MAGIC
# MAGIC ※https://learn.microsoft.com/ja-jp/azure/databricks/lakehouse/#lakehouse-vs-data-lake-vs-data-warehouse を ChatGPT に要約させた
# MAGIC
# MAGIC データウェアハウスはBI分析向けに設計され、クリーンで構造化されたデータを提供する一方、データレイクは多様なデータタイプを柔軟に格納するため、BIレポートには適さない。データレイクハウスはこれらの特性を兼ね備え、以下の点でデータ品質を向上させる。
# MAGIC
# MAGIC - **標準データ形式での格納と直接アクセス**:
# MAGIC   データレイクハウスでは、データを標準化された形式で格納し、直接アクセスできる。この特性により、データの整合性が向上し、データ品質が高まる。
# MAGIC
# MAGIC - **機械学習とデータサイエンス用のインデックス作成プロトコル**:
# MAGIC   データレイクハウスは、機械学習やデータサイエンスに適したインデックス作成プロトコルを提供する。これにより、データの探索や分析が迅速かつ正確に行える。
# MAGIC
# MAGIC - **BIと高度な分析のための低いクエリ待機時間と高い信頼性**:
# MAGIC   クエリ待機時間が短く、高い信頼性を持つデータレイクハウスは、BIレポートや高度な分析に適している。これにより、データ品質の向上とともに、ビジネス上の意思決定が迅速に行える。
# MAGIC
# MAGIC - **最適化されたメタデータレイヤーと検証済みデータ**:
# MAGIC   データレイクハウスは、最適化されたメタデータレイヤーや検証済みデータを組み合わせることで、データ品質を向上させる。これにより、データの信頼性が高まり、分析結果の正確性が確保される。
# MAGIC
# MAGIC データレイクハウスは、データウェアハウスとデータレイクの利点を統合し、データ品質の改善とビジネス価値の最大化を図る。

# COMMAND ----------

# MAGIC %md
# MAGIC ## ● シルバーテーブルとゴールドテーブルを比較対照し、どのワークロードでソースとしてブロンズテーブルを使用し、どのワークロードでソースとしてゴールドテーブルを使用するのかを判断する。
# MAGIC
# MAGIC ### ○ 参考記事の要約 by ChatGPT
# MAGIC
# MAGIC #### 1. シルバーテーブル
# MAGIC - シルバーテーブルは、検証済みかつエンリッチされたデータを含んでいる。
# MAGIC - ソースとしてブロンズテーブルを使用するワークロードは、シルバーテーブルにアクセスする。これは、検証済みかつエンリッチされたデータを必要とするワークロードであり、信頼性が重視される場合に適している。
# MAGIC - シルバーテーブルでは、データの重複を除去し、ダウンストリーム分析における信頼性を確保する。
# MAGIC
# MAGIC #### 2. ゴールドテーブル
# MAGIC - ゴールドテーブルは、高度に洗練され、集約されたデータを含んでいる。分析、機械学習、運用アプリケーションを強化するデータがここに格納される。
# MAGIC - ソースとしてゴールドテーブルを使用するワークロードは、分析や機械学習などの高度な処理を行う場合に適している。ここでは、データの変換や加工が済んだ品質の高いデータが提供される。
# MAGIC - ゴールドテーブルは、定期的にスケジュールされた運用ワークロードの一部として更新されるため、データの最新性と品質を確保する。
# MAGIC
# MAGIC 以上のように、シルバーテーブルは検証済みかつエンリッチされたデータを提供し、ブロンズテーブルからのソースとして適している。一方、ゴールドテーブルは高度な分析や機械学習を行うワークロードに適しており、品質の高いデータを提供する。それぞれのテーブルは異なるワークロードに対応し、効率的なデータ処理と分析を可能にする。
# MAGIC
# MAGIC ### ○ セミナーでの説明（汚いメモ）を補足として追記
# MAGIC ```
# MAGIC ・メダリオンアーキテクチャ
# MAGIC   ブロンズ
# MAGIC     生データと履歴（Raw ingestion and history）
# MAGIC   シルバー
# MAGIC     フィルタリング・クレンジング・データ拡張（Filtered,cleaned,autmented）
# MAGIC     きれいにしたデータ
# MAGIC     集計はしない
# MAGIC   ゴールド
# MAGIC     ビジネスレベルの集約（business-level aggregates）
# MAGIC     ML用のデータとか
# MAGIC     集計したもの
# MAGIC ```
# MAGIC
# MAGIC
# MAGIC ### ○ 参考記事
# MAGIC - メダリオン レイクハウス アーキテクチャとは
# MAGIC   - https://learn.microsoft.com/ja-jp/azure/databricks/lakehouse/medallion
# MAGIC

# COMMAND ----------

# MAGIC %md
# MAGIC ## ● データプレーンとコントロールプレーンに配置される要素や、顧客のクラウドアカウント内に存在する要素など、Databricks プラットフォームアーキテクチャに含まれる要素を特定する
# MAGIC
# MAGIC ### ○ 参考記事の要約 by ChatGPT
# MAGIC
# MAGIC Databricksプラットフォームは、データプレーンとコントロールプレーンの2つの主要なコンポーネントで構成されている。それぞれのプレーンに配置される要素や、顧客のクラウドアカウント内に存在する要素について説明する。
# MAGIC
# MAGIC #### ▽ データプレーン
# MAGIC データプレーンは、顧客のデータを処理する場所であり、主に以下の要素が含まれる。
# MAGIC
# MAGIC - **クラスター**:
# MAGIC   - Databricksのクラスターは、データプレーン内に存在し、データ処理と計算を実行する。これらのクラスターは、顧客のクラウドアカウント内で管理される。
# MAGIC   
# MAGIC - **データストレージ**:
# MAGIC   - データプレーンは、顧客のデータストレージと連携し、データを直接処理する。これには、AWS S3やAzure Data Lake Storageなどのクラウドストレージサービスが含まれる。
# MAGIC   
# MAGIC - **ネットワークセキュリティ**:
# MAGIC   - データプレーンは、顧客の仮想ネットワーク（VNetやVPC）内で運用され、ネットワークセキュリティを確保する。
# MAGIC
# MAGIC #### ▽ コントロールプレーン
# MAGIC コントロールプレーンは、Databricksの管理とオーケストレーションを行う場所であり、以下の要素が含まれる。
# MAGIC
# MAGIC - **Databricksワークスペース**:
# MAGIC   - ワークスペースは、ユーザーがDatabricksの機能にアクセスし、ノートブックやジョブを管理するためのインターフェースである。
# MAGIC
# MAGIC - **APIおよびユーザーインターフェース**:
# MAGIC   - コントロールプレーンは、REST APIやウェブベースのユーザーインターフェースを提供し、ユーザーがクラスター管理、データアクセス、ジョブのスケジューリングを行うための手段を提供する。
# MAGIC
# MAGIC - **ジョブスケジューラー**:
# MAGIC   - ジョブスケジューラーは、定期的なバッチ処理やデータパイプラインの実行を管理する。
# MAGIC
# MAGIC - **セキュリティおよびガバナンス**:
# MAGIC   - コントロールプレーンは、認証、認可、監査ログなどのセキュリティ機能を提供し、データのガバナンスを確保する。
# MAGIC
# MAGIC #### ▽ 顧客のクラウドアカウント内に存在する要素
# MAGIC 顧客のクラウドアカウント内には、主に以下の要素が存在する。
# MAGIC
# MAGIC - **Databricksクラスター**:
# MAGIC   - 顧客のクラウドアカウント内で起動されるクラスターは、データプレーンの一部として動作する。
# MAGIC   
# MAGIC - **データストレージ**:
# MAGIC   - データは、顧客のクラウドストレージサービスに保存される。
# MAGIC   
# MAGIC - **ネットワークリソース**:
# MAGIC   - 仮想ネットワーク、サブネット、セキュリティグループなどのネットワークリソースは、顧客のクラウドアカウント内に配置される。
# MAGIC
# MAGIC このように、Databricksプラットフォームはデータプレーンとコントロールプレーンに分かれ、それぞれが特定の役割を担い、顧客のクラウドアカウント内で適切に管理される要素を含んでいる。
# MAGIC
# MAGIC ### ○ 参考記事
# MAGIC - Azure Databricks アーキテクチャの概要
# MAGIC   - https://learn.microsoft.com/ja-jp/azure/databricks/getting-started/overview
# MAGIC

# COMMAND ----------

# MAGIC %md
# MAGIC ## ● All-Purpose クラスターとジョブクラスターの違いを理解する。
# MAGIC
# MAGIC ### ○ 参考記事からの抜粋
# MAGIC
# MAGIC - "汎用クラスター" は UI、CLI、または REST API を使用して作成します。 汎用クラスターは手動で終了および再起動できます。 複数のユーザーでこのようなクラスターを共有して、共同作業による対話型分析を行うことができます。
# MAGIC - Azure Databricks ジョブ スケジューラーでは、ユーザーが "新しいジョブ クラスター" でジョブを実行すると "ジョブ クラスター" が作成され、ジョブが完了するとクラスターが終了します。 ジョブ クラスターを再起動することは "できません"。
# MAGIC
# MAGIC - 汎用コンピューティング: ノートブック内のデータを分析するために使用されるプロビジョニングされたコンピューティング。 このコンピューティングは、UI、CLI、または REST API を使って作成、終了、再起動できます。
# MAGIC
# MAGIC - ジョブ コンピューティング: 自動ジョブの実行に使用されるプロビジョニングされたコンピューティング。 Azure Databricks ジョブ スケジューラは、新しいコンピューティングで実行するようにジョブが構成されるたびに、ジョブ コンピューティングを自動的に作成します。 そのコンピューティングは、ジョブが完了すると終了します。 ジョブ コンピューティングを再起動することは "できません"。 「ジョブで Azure Databricks コンピューティングを使用する」を参照してください。
# MAGIC
# MAGIC ### ○ 参考記事
# MAGIC - クラスター
# MAGIC   - https://learn.microsoft.com/ja-jp/azure/databricks/getting-started/concepts#cluster
# MAGIC - コンピューティングの種類
# MAGIC   - https://learn.microsoft.com/ja-jp/azure/databricks/compute/#types-of-compute
# MAGIC

# COMMAND ----------

# MAGIC %md
# MAGIC ## ● Databricks Runtime を使用したクラスターソフトウェアのバージョン管理方法を特定する。
# MAGIC
# MAGIC ### ○ 
# MAGIC
# MAGIC ### ○ セミナーでの説明（汚いメモ）を補足として追記
# MAGIC ```
# MAGIC
# MAGIC ```
# MAGIC
# MAGIC
# MAGIC ### ○ 参考記事
# MAGIC - XXX
# MAGIC   - https://
# MAGIC

# COMMAND ----------

# MAGIC %md
# MAGIC ## ● 
# MAGIC
# MAGIC ### ○ 
# MAGIC
# MAGIC ### ○ セミナーでの説明（汚いメモ）を補足として追記
# MAGIC ```
# MAGIC
# MAGIC ```
# MAGIC
# MAGIC
# MAGIC ### ○ 参考記事
# MAGIC - XXX
# MAGIC   - https://
# MAGIC

# COMMAND ----------


